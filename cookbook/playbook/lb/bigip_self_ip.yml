---
- hosts: bigip
  connection: ansible.builtin.local
  gather_facts: false
  var:
    interface_info:
      - { name: "internal_selfip" ,  addr_info: "192.168.1.70/24", vlan: "internal" }
      - { name: "external_selfip" , addr_info: "192.168.1.70/24", vlan: "external" }
      - { name: "HA_selfip" ,  addr_info: "192.168.1.70/24", vlan: "HA" }

  tasks:
    - name: create selfip(non-flooting)
      f5networks.f5_modules.bigip_selfip:
        state: present
        name: "{{ item.name }}"
        address: "{{ '{{ item.addr_info }}' | ansible.netcommon.ipaddr('address') }}"
        netmask: "{{ '{{ item.addr_info }}' | ansible.netcommon.ipaddr('netmask') }}"
        vlan: "{{ item.vlan }}"
        allow_service: default
        traffic_group: /Common/traffic-group-local-only
      loop: "{{ interface_info }}"
